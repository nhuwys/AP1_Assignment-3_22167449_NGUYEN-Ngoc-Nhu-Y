---
title: "Assignment 3"
author: "NGUYEN Ngoc Nhu Y"
output: pdf_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      comment = "",
                      message = FALSE,
                      warning = FALSE)
```

# Task 1

```{r}
#Read the dataset and replace "?" with NA
engine <- read.csv("Engine.csv", na.strings = "?")
automobile <- read.csv("Automobile.csv", na.strings = "?")
maintenance <- read.csv("Maintenance.csv", na.strings = "?")
```

```{r}
#Inspect the structure of the dataset "Engine.csv"
str(engine)
#Inspect the structure of the dataset "Automobile.csv"
str(automobile)
#Inspect the structure of the dataset "Maintenance.csv"
str(maintenance)
```

```{r}
#Count total missing values after replacing "?" with NA
cat("Missing values in Engine:", sum(is.na(engine)), "\n")
cat("Missing values in Automobile:", sum(is.na(automobile)), "\n")
cat("Missing values in Maintenance:", sum(is.na(maintenance)), "\n")
```

```{r}
# Check which columns contain NA in the Engine dataset
colSums(is.na(engine))
# Count number of rows in Engine affected by missing values
rows_with_na <- sum(rowSums(is.na(engine)) > 0)
cat("Rows with missing values in Engine:", rows_with_na, "\n")
```

## **Notes:**

Only Engine has missing values "?" (Engine = 6, Automobile & Maintenance
= 0).

-\> only Engine has affected rows (Missing values occur only in
Horsepower)

-\> only Engine needs cleaning

When inspecting the column, it is appeared that there are:

-   5 missing entries occur in EngineType

-   1 missing entry occurs in Horsepower

**Replacing "?" with NA does not change the distribution because no
actual values are modified; NA only marks missing entries.**

```{r}
#Convert categorical variables to factors
automobile$BodyStyles <- as.factor(automobile$BodyStyles)
engine$FuelTypes <- as.factor(engine$FuelTypes)
maintenance$ErrorCodes <- as.factor(maintenance$ErrorCodes)

#Compute the median Horsepower for imputation
median_hp <- median(engine$Horsepower, na.rm = TRUE)

#Replace the missing Horsepower values with median
engine$Horsepower[is.na(engine$Horsepower)] <- median_hp
```

Horsepower is a numerical variable

-\> use median -\> resistant to outliers and preserves the central
tendency

**Note on EngineType missing values:** EngineType is categorical;
missing entries were retained as NA and it is only required to replace
missing Horsepower values.

## Distribution of Horsepower Across Engine Types

```{r}
# Distribution of Horsepower Across Engine Types
library(ggplot2)

#Visualize Horsepower distribution
ggplot(engine, aes(x = Horsepower)) +
  geom_histogram(binwidth = 10, fill = "skyblue", color = "black") +
  labs(title = "Distribution of Horsepower", 
       x = "Horsepower", 
       y = "Count")
```

The histogram indicates a strongly right-skewed distribution. The
majority of Horsepower values are concentrated between 50 and 170,
suggesting that most engines in the dataset belong to small to mid-sized
vehicles. However, the long right tail indicates several high-horsepower
engines, which act as outliers.

Since the missing values were replaced with the median horsepower, the
distribution remains stable and does not shift. This is expected because
the median is robust to extreme values and represents the central
tendency of the dataset.

############################################################### 

# Task 2

## Horsepower Distribution Across Engine Types

```{r}
# Distribution of Horsepower Across Engine Types
library(ggplot2)

# Histogram of Horsepower for each engine type
ggplot(engine, aes(x = Horsepower, fill = EngineType)) +
  geom_histogram(binwidth = 10, alpha = 0.6, color = "black") +
  facet_wrap(~EngineType, scales="free_y") +
  labs(title = "Horsepower Distribution Across Engine Types",
       x = "Horsepower",
       y = "Count",
       fill = "Engine Types")
```

The distribution of horsepower varies noticeably across different engine
types. OHC engines appear most frequently in the dataset and generally
fall within the low- to mid-range horsepower levels, indicating that
they are typically used in standard consumer vehicles. In contrast, DOHC
and OHCV engines display a wider spread and extend into higher
horsepower ranges, suggesting that these engine types are associated
with stronger performance capabilities. Rotor engines are rare and
exhibit a very narrow horsepower distribution, highlighting their
limited use in this dataset.

=\> The engine type is closely related to the achievable horsepower,
with more advanced configurations tending to produce greater power.

## Horsepower Distribution Across Engine Size Groups

```{r}
# Create Engine Size Groups
engine$SizeGroup <- cut(engine$EngineSize,
  breaks = c(60, 90, 190, 299, Inf),
  labels = c("60-90", "91-190", "191-299", "300+"))

#Create table for Engine Size Groups
table (engine$SizeGroup)

#Facet_wrap Histogram of Horsepower by Size Groups
ggplot(engine, aes(x = Horsepower, fill = SizeGroup)) +
  geom_histogram(binwidth = 10, alpha = 0.6, color = "black") +
  facet_wrap(~ SizeGroup, scales = "free_y") +
  labs(title = "Horsepower Distribution Across Engine Size Groups",
       x = "Horsepower", 
       y = "Count",
       fill = "Engine Size Group")
```

> When horsepower is examined across the engine size groups, the
> distribution reveals that the majority of engines belong to the 91-190
> size range, which corresponds to mid-sized engines commonly found in
> everyday vehicles.These engines have a broad horsepower spread but
> remain mostly within standard performance levels.Smaller engines in
> the 60-90 group show notably lower horsepower values, reflecting their
> limited power output.Engines in the 191-299 group shift toward higher
> horsepower ranges but occur much less frequently, while engines in the
> 300+ group are extremely rare and represent high-performance or
> specialized models. =\> Clear relationship between engine size and
> horsepower, where larger engines tend to support higher power
> capacity.